# 功能实现

## 文件

记事本的 `文件` 中的逻辑比较复杂（修改后是否保存，在打开、新建中很多种情况）

这里简单处理：
- 新建就是刷新文本编辑区域
- 打开就是打开新的文件

---

```
// index.js

const ipc = require('electron').ipcRenderer;
const fs = require('fs');


// 打开文件后的初始内容
var initContent;


// 监听主进程action事件
ipc.on('action', (event, message, others) => {
    var nowContent = document.getElementById('txtEditor').value
    switch (message) {
        case 'new':
            if (!document.getElementById('txtEditor').style.display)
                document.getElementById('txtEditor').style.display = 'block';
            document.getElementById('txtEditor').value = '';
            break;
        case 'open':
            var filepath = others[0];
            fs.readFile(filepath, 'utf8', (err, data) => {
                if (err) console.log(err);
                if (!document.getElementById('txtEditor').style.display)
                    document.getElementById('txtEditor').style.display = 'block';
                initContent = data;
                document.getElementById('txtEditor').value = data;
            })
            break;
        case 'save':
            var filepath = others;
            fs.writeFile(filepath, document.getElementById('txtEditor').value, (err) => {
                if (!err) {
                    initContent = document.getElementById('txtEditor').value
                    alert('保存成功');
                    return;
                }
                alert(err);
            })

    };

});


```

---
